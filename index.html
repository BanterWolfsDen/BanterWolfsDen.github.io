<html>
  <head>
    <meta property="og:title" content="Avatar Attachments">
    <meta property="og:description" content="This easy example shows how to attach objects to your avatar!">
    <meta property="og:image" content="https://user-images.githubusercontent.com/6830845/206165866-a5a1d387-61b3-4631-90e5-623d2fe19647.png">  
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script>
      const videos = [
        "https://www.youtube.com/watch?v=-72P_EFphSc",
        "https://www.youtube.com/watch?v=KqcOR6x8PTo",
        "https://www.youtube.com/watch?v=FMdNObc5vAQ"
      ];
      
      let currentlyPlaying = 0;
      
      const playPrevVideo = async (id) => {
        currentlyPlaying--;
        playVideo(id, videos[currentlyPlaying])
      }
      
      const playNextVideo = async (id) => {
        currentlyPlaying++;
        playVideo(id, videos[currentlyPlaying])
      }
      
      AFRAME.registerComponent('video-player', {
          init: async function() {
            let duration = 0;
              this.el.addEventListener('video-player', (e) => {
                    console.log(e.detail.eventType);
                switch(this.el.object3D.userData.eventType) {
                  case "MetaDataReady":
                    // duration = this.el.object3D.userData.duration;
                    // console.log(this.el.object3D.userData.eventType);
                    break;
                  case "Started":
                    // duration = this.el.object3D.userData.duration;
                    // console.log(this.el.object3D.userData.eventType);
                    break;
                  case "FinishedPlaying":
                    // console.log(this.el.object3D.userData.eventType);
                    // playNextVideo(this.el.object3D.id);
                    break;
                }
              });
          }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <a-assets>
          <video id="youtube-video" src="https://www.youtube.com/watch?v=MwcHGHbz528" loop="true" muted="true" volume="0.5"></video>
        </a-assets>
<!--       https://www.youtube.com/watch?v=-72P_EFphSc -->
      <a-sound src="src: url(click.mp3)" autoplay="true" position="0 2 5"></a-sound>

      <a-camera look-controls wasd-controls="fly: true"></a-camera>
      
      <!-- A big box for the floor with a collider on it -->
      <a-box sq-collider color="olive" scale="30 0.1 30"></a-box>
      
      <!-- A 3d model of a christmas tree, because why not! -->
      <a-entity position="-7 0 -4" scale="40 40 40" gltf-model="https://cdn.glitch.global/7af396ad-5845-48f2-8441-58c6ffec91ad/low-poly_fangding_food_vessel.glb?v=1670411591590"></a-entity>
            
      <a-video src="#youtube-video" video-player rotation="0 0 0" position="0 0 -3"></a-video>
      
      
      <!-- A mirror! -->
      <a-entity sq-mirror position="0 1 10" rotation="0 180 0" scale="4 4 4"></a-entity>
    
      <!-- A portal back to the previous space! -->
      <a-link id="portal" position="-10 0 8" rotation="0 45 0" title="Community Hub" href="https://sq-community-hub.glitch.me" image="https://logo.clearbit.com/sidequestvr.com"></a-link>
      </a-scene>
  </body>
</html>