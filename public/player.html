<html>
  <head>
    <link href="./playlist.css" rel="stylesheet">
    <script src="https://www.youtube.com/iframe_api"></script>
  </head>  
  <body>
  
    <div id="player">
      
    </div>
    <script> 
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      
      let getId = (url) => {
        var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
        var match = url.match(regExp);
        return (match&&match[7].length==11)? match[7] : false;
      }
      let video = document.getElementById("videoFrame");
      const urlParams = new URLSearchParams(window.location.search);      
      // let url = 'https://www.youtube-nocookie.com/embed/' + getId(url_decode(urlParams.get('youtube'))) + '?autoplay=1&controls=1&disablekb=1&enablejsapi=1&iv_load_policy=3&origin=https%3A%2F%2Fsq-synced-videoplayer.glitch.me&start=0&playsinline=1&widgetid=1';
      
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: window.innerHeight,
          width: window.innerWidth,
          videoId: getId(decodeURIComponent(urlParams.get('youtube'))),
          playerVars: {
            'playsinline': 1,
            'autoplay': 0,
            'controls': 0,
            'disablekb': 1,
            'origin': 'https://sq-synced-videoplayer.glitch.me',
            'start': urlParams.get('start') || 0
          },
          events: {
            'onReady': (event) => {
              console.log('ready');
              event.target.playVideo();
              console.log('video should be playing?');
            }
          }
        });
      }
    
    </script>
  </body>
</html>